<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contando Moeda - Gerador de Roteiro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide-react@0.292.0/dist/umd/lucide.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .loader {
            border-top-color: #4f46e5;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab-btn.active {
            color: #4f46e5;
            border-color: #4f46e5;
        }
        [data-lucide] {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-3xl">
        <!-- Cabeçalho -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">Contando Moeda</h1>
            <p class="text-lg text-gray-600 mt-2">Porque a grana é pouca, mas o mundo é gigante</p>
        </header>

        <!-- Formulário de Input -->
        <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
            <form id="roteiro-form" class="space-y-4">
                <div>
                    <label for="destino" class="block text-sm font-medium text-gray-700 mb-1">Destino</label>
                    <input type="text" id="destino" name="destino" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Ex: Lisboa, Portugal" required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="dias" class="block text-sm font-medium text-gray-700 mb-1">Nº de Dias</label>
                        <input type="number" id="dias" name="dias" min="1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Ex: 7" required>
                    </div>
                     <div>
                        <label for="data" class="block text-sm font-medium text-gray-700 mb-1">Data da Viagem</label>
                        <input type="month" id="data" name="data" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" required>
                    </div>
                </div>
                <div>
                    <button type="submit" id="submit-btn" class="w-full bg-indigo-600 text-white font-bold py-4 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all transform hover:scale-105 flex items-center justify-center">
                        <span id="btn-text">Gerar Roteiro (Modo Demo)</span>
                        <div id="btn-loader" class="hidden loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-6 w-6 ml-3" style="border-top-color: white;"></div>
                    </button>
                </div>
            </form>
        </div>

        <!-- Feedback para o usuário -->
        <div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
            <strong class="font-bold">Opa!</strong>
            <span class="block sm:inline">Algo deu errado. Tente de novo, talvez a gente se perdeu no caminho.</span>
        </div>


        <!-- Container dos Resultados -->
        <div id="resultado-roteiro" class="hidden">
            <!-- Header do resultado -->
             <div id="resultado-header" class="text-center mb-6"></div>
             <!-- Abas de Navegação -->
             <div class="bg-white rounded-lg shadow-sm mb-6 sticky top-2 z-10">
                 <nav id="tabs" class="flex justify-around border-b"></nav>
             </div>
             <!-- Conteúdo das Abas -->
             <div id="tab-contents" class="space-y-6"></div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            const today = new Date();
            const month = (today.getMonth() + 1).toString().padStart(2, '0');
            const year = today.getFullYear();
            document.getElementById('data').value = `${year}-${month}`;
        });
        
        // --- MODO DE DEMONSTRAÇÃO ---
        // Dados de exemplo para evitar a chamada de API e o uso de chave
        const sampleData = {
          "cidade": "Lisboa",
          "pais": "Portugal",
          "estimativa_custo": {
            "moeda_local": "EUR",
            "valor_total_aproximado": 350,
            "detalhes": "Custo estimado para 5 dias, com base em hostel (25€/dia), alimentação económica (25€/dia) e transporte/passeios (20€/dia)."
          },
          "checklist_bagagem": {
            "Roupas Essenciais": ["Tênis confortável para caminhada", "Casaco leve (mesmo no verão)", "Calças de ganga/jeans", "T-shirts e Camisolas", "Pijama"],
            "Higiene": ["Protetor solar", "Itens básicos de higiene", "Toalha de secagem rápida"],
            "Eletrônicos": ["Carregador portátil (Power bank)", "Adaptador de tomada europeu", "Telemóvel e carregador"]
          },
          "sugestoes_hospedagem": [
            { "nome": "Yes! Lisbon Hostel", "descricao": "Famoso pela atmosfera social e jantares comunitários. Ótimo para conhecer outros viajantes." },
            { "nome": "Goodmorning All-Inclusive Hostel", "descricao": "Oferece um dos melhores pequenos-almoços e atividades diárias incluídas na diária." },
            { "nome": "Lost Inn Lisbon Hostel", "descricao": "Localizado no Chiado, super central, com um staff amigável e ambiente acolhedor." }
          ],
          "dicas_economia": {
            "alimentacao": ["Tascas e restaurantes em Alfama e Mouraria", "Menus do dia ao almoço (prato, bebida e café)", "Pastelarias para lanches baratos (salgados e doces)"],
            "lembrancinhas": ["Feira da Ladra (Terças e Sábados)", "Lojas de souvenirs na Rua Augusta (pesquisar preços)", "Produtos de cortiça são um clássico local"]
          },
          "roteiro_diario": [
            { "dia": 1, "titulo": "Chegada e o Coração de Lisboa", "atividades": ["Explorar a Baixa Pombalina (Rua Augusta, Praça do Comércio)", "Subir o Elevador de Santa Justa para uma vista incrível", "Jantar e ouvir Fado no bairro de Alfama"], "dica_logistica": "Compre o cartão 'Viva Viagem' para usar em todo o transporte público. Carregue com a opção 'Zapping'.", "tempo_respirar": "Sente-se nas escadarias da Praça do Comércio a ver o Tejo e os barcos a passar." },
            { "dia": 2, "titulo": "História e Pastéis de Nata", "atividades": ["Visitar a Torre de Belém", "Explorar o Mosteiro dos Jerónimos", "Provar os autênticos Pastéis de Belém"], "dica_logistica": "Apanhe o elétrico 15E na Praça da Figueira para chegar a Belém de forma fácil e cénica.", "tempo_respirar": "Faça um piquenique no Jardim da Torre de Belém com um pastel de nata e um café." },
            { "dia": 3, "titulo": "Vistas, Elétricos e Bairros", "atividades": ["Apanhar o famoso elétrico 28", "Perder-se nas ruelas do Castelo de São Jorge", "Ver o pôr do sol no Miradouro da Senhora do Monte (a melhor vista!)"], "dica_logistica": "O bilhete do elétrico 28 pode ser comprado a bordo, mas é mais caro. Use o seu cartão Viva Viagem.", "tempo_respirar": "Tome uma ginjinha (licor de cereja) num dos pequenos bares de Alfama." }
          ]
        };

        const form = document.getElementById('roteiro-form');
        const resultadoDiv = document.getElementById('resultado-roteiro');
        const errorMessage = document.getElementById('error-message');
        const submitBtn = document.getElementById('submit-btn');
        const btnText = document.getElementById('btn-text');
        const btnLoader = document.getElementById('btn-loader');


        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            resultadoDiv.classList.add('hidden');
            errorMessage.classList.add('hidden');
            submitBtn.disabled = true;
            btnText.textContent = 'A gerar...';
            btnLoader.classList.remove('hidden');
            
            // Simula uma pequena demora, como se estivesse a chamar a API
            await new Promise(resolve => setTimeout(resolve, 1000));

            try {
                // Em vez de chamar a API, usamos os nossos dados de exemplo
                const data = sampleData; 
                
                // Ajustamos o número de dias no exemplo para corresponder ao input do usuário, para uma melhor demonstração
                const diasInput = parseInt(document.getElementById('dias').value) || 3;
                data.roteiro_diario = sampleData.roteiro_diario.slice(0, diasInput);
                if(data.roteiro_diario.length === 0 && sampleData.roteiro_diario.length > 0){
                    data.roteiro_diario.push(sampleData.roteiro_diario[0]);
                }

                displayRoteiro(data);

            } catch (error) {
                console.error("Erro ao exibir roteiro de demonstração:", error);
                errorMessage.classList.remove('hidden');
            } finally {
                submitBtn.disabled = false;
                btnText.textContent = 'Gerar Roteiro (Modo Demo)';
                btnLoader.classList.add('hidden');
            }
        });

        function createMapLink(query, city) {
            const encodedQuery = encodeURIComponent(`${query}, ${city}`);
            return `https://www.google.com/maps/search/?api=1&query=${encodedQuery}`;
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.tab-btn[data-tab="${tabName}"]`).classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        function displayRoteiro(data) {
            resultadoDiv.classList.remove('hidden');
            const headerDiv = document.getElementById('resultado-header');
            const tabsDiv = document.getElementById('tabs');
            const tabContentsDiv = document.getElementById('tab-contents');

            headerDiv.innerHTML = '';
            tabsDiv.innerHTML = '';
            tabContentsDiv.innerHTML = '';
            
            headerDiv.innerHTML = `
                <h2 class="text-3xl font-bold text-gray-800">Seu Roteiro para ${data.cidade}</h2>
                <p class="text-md text-gray-500">Viagem de ${data.roteiro_diario.length} dias (Exemplo)</p>`;

            // -- Abas e Conteúdos --
            
            tabsDiv.innerHTML += `<button class="tab-btn flex-1 p-4 font-semibold border-b-2 border-transparent transition-colors" data-tab="roteiro"><i data-lucide="map"></i>Roteiro</button>`;
            let roteiroHtml = `<div id="tab-roteiro" class="tab-content space-y-6">`;
            data.roteiro_diario.forEach((dia, index) => {
                let atividadesHtml = '<ul class="space-y-3">';
                dia.atividades.forEach(atividade => {
                    atividadesHtml += `<li class="flex items-start"><i data-lucide="check-circle-2" class="text-green-500 mt-1 flex-shrink-0"></i><span>${atividade} <a href="${createMapLink(atividade, data.cidade)}" target="_blank" class="text-indigo-600 hover:underline text-sm ml-1">(Ver no mapa)</a></span></li>`;
                });
                atividadesHtml += '</ul>';

                roteiroHtml += `
                    <div class="bg-white p-6 rounded-2xl shadow-lg fade-in" style="animation-delay: ${index * 100}ms">
                        <h3 class="text-xl font-bold mb-4 text-indigo-700 flex items-center"><i data-lucide="calendar-days"></i>Dia ${dia.dia}: ${dia.titulo}</h3>
                        <div class="space-y-4">
                            <div><h4 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="list-checks"></i>Atividades do Dia</h4>${atividadesHtml}</div>
                            <div class="p-4 bg-indigo-50 rounded-lg"><h4 class="font-semibold flex items-center"><i data-lucide="bus"></i>Dica de Logística</h4><p class="text-gray-700 ml-7">${dia.dica_logistica}</p></div>
                            <div class="p-4 bg-emerald-50 rounded-lg"><h4 class="font-semibold flex items-center"><i data-lucide="coffee"></i>Tempo de Respirar</h4><p class="text-gray-700 ml-7">${dia.tempo_respirar}</p></div>
                        </div>
                    </div>`;
            });
            roteiroHtml += `</div>`;
            tabContentsDiv.innerHTML += roteiroHtml;

            tabsDiv.innerHTML += `<button class="tab-btn flex-1 p-4 font-semibold border-b-2 border-transparent transition-colors" data-tab="mala"><i data-lucide="suitcase"></i>Mala</button>`;
            let checklistHtml = `<div id="tab-mala" class="tab-content"><div class="bg-white p-6 rounded-2xl shadow-lg space-y-4 fade-in">`;
            for (const categoria in data.checklist_bagagem) {
                checklistHtml += `<h4 class="font-semibold text-lg pt-2">${categoria}</h4><ul class="text-gray-700 space-y-2">`;
                data.checklist_bagagem[categoria].forEach(item => {
                    checklistHtml += `<li class="flex items-center"><i data-lucide="check" class="text-gray-400 w-4 h-4 mr-2"></i>${item}</li>`;
                });
                checklistHtml += `</ul>`;
            }
            checklistHtml += `</div></div>`;
            tabContentsDiv.innerHTML += checklistHtml;
            
            tabsDiv.innerHTML += `<button class="tab-btn flex-1 p-4 font-semibold border-b-2 border-transparent transition-colors" data-tab="dicas"><i data-lucide="piggy-bank"></i>Dicas</button>`;
            let dicasHtml = `<div id="tab-dicas" class="tab-content space-y-6">`;
            dicasHtml += `<div class="bg-white p-6 rounded-2xl shadow-lg fade-in"><h3 class="text-xl font-bold mb-3 flex items-center"><i data-lucide="wallet"></i>Estimativa de Custo</h3><p class="text-3xl font-bold text-indigo-600">${data.estimativa_custo.valor_total_aproximado} <span class="text-lg font-medium text-gray-500">${data.estimativa_custo.moeda_local}</span></p><p class="text-sm text-gray-500 mt-2">${data.estimativa_custo.detalhes}</p></div>`;
            dicasHtml += `<div class="bg-white p-6 rounded-2xl shadow-lg fade-in" style="animation-delay: 100ms"><h3 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="bed-double"></i>Sugestões de Hostels</h3><div class="space-y-4">`;
            data.sugestoes_hospedagem.forEach(hostel => {
                dicasHtml += `<div><h4 class="font-semibold">${hostel.nome}</h4><p class="text-sm text-gray-600">${hostel.descricao} <a href="${createMapLink('Hostel ' + hostel.nome, data.cidade)}" target="_blank" class="text-indigo-600 hover:underline">(Pesquisar)</a></p></div>`;
            });
            dicasHtml += `</div></div>`;
            dicasHtml += `<div class="bg-white p-6 rounded-2xl shadow-lg fade-in" style="animation-delay: 200ms"><h3 class="text-xl font-bold mb-4 flex items-center"><i data-lucide="lightbulb"></i>Dicas para Economizar</h4><div class="space-y-4"><div><h4 class="font-semibold text-lg flex items-center"><i data-lucide="utensils-crossed"></i>Comida</h4>`;
            data.dicas_economia.alimentacao.forEach(dica => {
                dicasHtml += `<p class="text-sm text-gray-600 ml-7">- ${dica}</p>`;
            });
            dicasHtml += `</div><div><h4 class="font-semibold text-lg flex items-center"><i data-lucide="gift"></i>Lembrancinhas</h4>`;
            data.dicas_economia.lembrancinhas.forEach(dica => {
                 dicasHtml += `<p class="text-sm text-gray-600 ml-7">- ${dica}</p>`;
            });
            dicasHtml += `</div></div></div>`;
            dicasHtml += `</div>`;
            tabContentsDiv.innerHTML += dicasHtml;

            // -- Lógica das Abas --
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    switchTab(btn.dataset.tab);
                });
            });
            
            switchTab('roteiro');
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }
    </script>
</body>
</html>
